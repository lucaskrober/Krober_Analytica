with(dados,lines(id,lscl4, col='2'));
with(dados,lines(id,lscl3, col='3'));
with(dados,lines(id,lscl2, col='4'));
with(dados,lines(id,lscl1, col='5'));
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
schu_ana='hd2~hd1*exp(b1*(1/id1-1/id2))'
ajsa=nls(schu_ana,data=dados,start=list(b1=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
sumário_ajsa=summary(ajsa);
hdest2=predict(ajsa);
errounid=residuals(ajsa);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajsa$sigma;
nsyx=round(sumário_ajsa$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajsa$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajsa$sigma/mean(dados$hd2))*100,5)))
dados=read.csv2('dados_ra.csv');
dados=subset(dados,estrato==573116);
betas=sumário_ajsa$coefficients
b1=betas[1];b1;
b2=betas[2];b2;
idref=72; #Idade de referência
schu_ana='hd2~hd1*exp(b1*(1/id1-1/id2))'
dados$sitio=with(dados, hd*exp(b1*(1/id-1/idref)));
(ls=max(dados$sitio));
(li=min(dados$sitio));
nls=37
nli=19
nclasses=4
(interv=(nls-nli)/nclasses);
#altura dominante da idade de referencia
#limite inferior da classe 4
hdiref=nli
dados$licl4=with(dados, hdiref*exp(b1*(1/idref-1/id)))
hdiref=hdiref+interv;
dados$lscl4=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl3=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl2=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl1=with(dados, hdiref*exp(b1*(1/idref-1/id)))
dados=dados[order(dados$id),];
x11();
with(dados,plot(id,hd,pch='*',col='red',ylim=c(0,30),
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
x11();
with(dados,plot(id,hd,pch='*',col='red',
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
write.csv2(dados,'curvas_schuana_poli.csv',row.names=F)
library(cmrinvflor);
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
schu_ana='hd2~hd1*exp(b1*(1/id1-1/id2))'
ajsa=nls(schu_ana,data=dados,start=list(b1=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
sumário_ajsa=summary(ajsa);
hdest2=predict(ajsa);
errounid=residuals(ajsa);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajsa$sigma;
nsyx=round(sumário_ajsa$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajsa$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajsa$sigma/mean(dados$hd2))*100,5)))
dados=read.csv2('dados_ra.csv');
dados=subset(dados,estrato==573116);
betas=sumário_ajsa$coefficients
b1=betas[1];b1;
b2=betas[2];b2;
idref=72; #Idade de referência
schu_ana='hd2~hd1*exp(b1*(1/id1-1/id2))'
dados$sitio=with(dados, hd*exp(b1*(1/id-1/idref)));
View(dados)
(ls=max(dados$sitio));
(li=min(dados$sitio));
nls=37
nli=19
nclasses=4
(interv=(nls-nli)/nclasses);
hdiref=nli
dados$licl4=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl4=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl3=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl2=with(dados, hdiref*exp(b1*(1/idref-1/id)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl1=with(dados, hdiref*exp(b1*(1/idref-1/id)))
View(dados)
dados=dados[order(dados$id),];
x11();
with(dados,plot(id,hd,pch='*',col='red', ylim=(0,40),
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,plot(id,hd,pch='*',col='red', ylim=c(0,40),
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
write.csv2(dados,'curvas_schuana_poli.csv',row.names=F)
x11();
with(dados,plot(id,hd,pch='*',col='red',
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
source('~/UFSCar2015.1/Manejo de plantadas/Trabalho FINAL/Schumacher Ana/Schu_ana.r')
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
View(dados_npar);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
schu_poli='hd2~b0*(hd1/b0)^(id1/id2))'
ajsp=nls(schu_poli,data=dados,start=list(b0=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
schu_poli='hd2~b0*(hd1/b0)^(id1/id2)'
ajsp=nls(schu_poli,data=dados,start=list(b0=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
sumário_ajsp=summary(ajsp);
summary(ajsp);
hdest2=predict(ajsp);
errounid=residuals(ajsp);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajsp$sigma;
nsyx=round(sumário_ajsp$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajsp$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajsp$sigma/mean(dados$hd2))*100,5)))
x11()
par(mfrow=c(1,3))
plot(predict(ajsp),residuals(ajsp),pch='*',
col=2,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajsp),xlab='resíduos(m)',ylab='frequência',main='');
plot(dados$id2,predict(ajsp),pch='*',col='red',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='blue');
x11()
par(mfrow=c(1,3))
plot(predict(ajsp),residuals(ajsp),pch='o',
col=2,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajsp),xlab='resíduos(m)',ylab='frequência',main='');
plot(dados$id2,predict(ajsp),pch='*',col='red',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='blue');
x11()
par(mfrow=c(1,3))
plot(predict(ajsp),residuals(ajsp),pch='*',
col=1,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajsp),xlab='resíduos(m)',ylab='frequência',main='');
plot(dados$id2,predict(ajsp),pch='*',col='black',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='green');
library(fBasics); #grafico quantil quantil para análise de Normalidade dos residuos
x11();
qqnormPlot(residuals(ajsp));
dados=read.csv2('dados_ra.csv');
dados=subset(dados,estrato==573116);
betas=sumário_ajsp$coefficients
b1=betas[1];b1;
b2=betas[2];b2;
idref=72; #Idade de referência
schu_poli='hd2~b0*(hd1/b0)^(id1/id2))'
dados$sitio=with(dados, b0*(hd/b0)^(id/idref)));
dados$sitio=with(dados, b0*(hd/b0)^(id/idref));
b0=betas[1];b0;
dados=read.csv2('dados_ra.csv');
dados=subset(dados,estrato==573116);
betas=sumário_ajsp$coefficients
b0=betas[1];b0;
idref=72; #Idade de referência
schu_poli='hd2~b0*(hd1/b0)^(id1/id2))'
dados$sitio=with(dados, b0*(hd/b0)^(id/idref));
View(dados)
(ls=max(dados$sitio));
(li=min(dados$sitio));
nls=32
nli=22
nclasses=4
(interv=(nls-nli)/nclasses);
hdiref=nli
dados$licl4=with(dados, b0*(hdiref/b0)^(idref/id))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl4=with(dados, b0*(hdiref/b0)^(idref/id))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl3=with(dados, b0*(hdiref/b0)^(idref/id))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl2=with(dados, b0*(hdiref/b0)^(idref/id))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl1=with(dados, b0*(hdiref/b0)^(idref/id))
View(dados)
dados=dados[order(dados$id),];
x11();
with(dados,plot(id,hd,pch='*',col='red', ylim=c(0,40),
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
write.csv2(dados,'curvas_schuana_poli.csv',row.names=F)
x11();
with(dados,plot(id,hd,pch='*',col='red',
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
dados_npar=read.csv2('dados_ra.csv')
dados_npar=subset(dados_npar,estrato==573116);
View(dados_npar)
library(cmrinvflor)
dados=parear_seqmed(
dados_npar[,c('parcela','id','hd','ab','vtcc')]);
x11();
with(dados_npar,plot(hd,vtcc,pch='*',col='green'));
bc_poli='hd2~b0*((hd1/b0)^((id1/id2)^b2))';
ajbcp=nls(bc_poli,dados,start=list(b0=50,b2=0.5));
(sumario=summary(ajbcp));
dados_npar=read.csv2('dados_ra.csv')
dados_npar=subset(dados_npar,estrato==573116);
library(cmrinvflor)
dados=parear_seqmed(
dados_npar[,c('parcela','id','hd','ab','vtcc')]);
bc_poli='hd2~b0*((hd1/b0)^((id1/id2)^b2))';
ajbcp=nls(bc_poli,dados,start=list(b0=50,b2=0.5));
sumário_ajbcp=summary(ajbcp);
(sumario=summary(ajbcp));
hdest2=predict(ajbcp);
errounid=residuals(ajbcp);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajbcp$sigma;
nsyx=round(sumário_ajbcp$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajbcp$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajbc$sigma/mean(dados$hd2))*100,5)))
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajbcp$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajbcp$sigma/mean(dados$hd2))*100,5)))
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=2,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajbcp),xlab='resíduos(m)',ylab='frequência',main='');
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=3,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=4,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=4,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=4,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=5,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=6,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=7,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=8,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=8,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=9,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=3,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajbcp),xlab='resíduos(m)',ylab='frequência',main='');
plot(dados$id2,predict(ajbcp),pch='*',col='blue',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='green');
hist(residuals(ajbcp),xlab='resíduos(m)',ylab='frequência',main='',col='red');
x11()
library(fBasics); #grafico quantil quantil para análise de Normalidade dos residuos
x11();
qqnormPlot(residuals(ajbcp));
dados=read.csv2('dados_ra.csv');
dados=subset(dados,estrato==573116);
betas=sumário_ajbcp$coefficients
b0=betas[1];b0;
b2-betas[2];b2
b0=betas[1];b0;
b2=betas[2];b2;
idref=72; #Idade de referência
dados$sitio=with(dados, b0*((hd/b0)^((id/idref)^b2)));
(ls=max(dados$sitio));
(li=min(dados$sitio));
nls=33
nli=22
nclasses=4
(interv=(nls-nli)/nclasses);
bc_poli='hd2~b0*((hd1/b0)^((id1/id2)^b2))';
hdiref=nli
dados$licl4=with(dados, b0*((hdiref/b0)^((idref/id)^b2)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl4=with(dados, b0*((hdiref/b0)^((idref/id)^b2)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl3=with(dados, b0*((hdiref/b0)^((idref/id)^b2)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl2=with(dados, b0*((hdiref/b0)^((idref/id)^b2)))
#limite superior da classe 4
hdiref=hdiref+interv;
dados$lscl1=with(dados, b0*((hdiref/b0)^((idref/id)^b2)))
View(dados)
dados=dados[order(dados$id),];
x11();
with(dados,plot(id,hd,pch='*',col='red',ylim=c(0,40),
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
x11();
with(dados,plot(id,hd,pch='*',col='red',
xlab='idade(meses)',ylab='hdom(m)'))
with(dados,lines(id,licl4,col=1));
with(dados,lines(id,lscl4,col=2));
with(dados,lines(id,lscl3,col=3));
with(dados,lines(id,lscl2,col=4));
with(dados,lines(id,lscl1,col=5));
write.csv2(dados,'curvas_bc_poli.csv',row.names=F)
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
schu_ana='hd2~hd1*exp(b1*(1/id1-1/id2))'
ajsa=nls(schu_ana,data=dados,start=list(b1=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
sumário_ajsa=summary(ajsa);
summary(ajsa); # eroo padrao residual+/-1,43m
hdest2=predict(ajsa);
errounid=residuals(ajsa);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajsa$sigma;
nsyx=round(sumário_ajsa$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajsa$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajsa$sigma/mean(dados$hd2))*100,5)))
x11()
par(mfrow=c(1,3))
plot(predict(ajsa),residuals(ajsa),pch='*',
col=2,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajsa),xlab='resíduos(m)',ylab='frequência',main='',col='red');
plot(dados$id2,predict(ajsa),pch='*',col='red',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='blue');
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
schu_poli='hd2~b0*(hd1/b0)^(id1/id2)'
ajsp=nls(schu_poli,data=dados,start=list(b0=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
sumário_ajsp=summary(ajsp);
summary(ajsp);
hdest2=predict(ajsp);
errounid=residuals(ajsp);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajsp$sigma;
nsyx=round(sumário_ajsp$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajsp$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajsp$sigma/mean(dados$hd2))*100,5)))
x11()
par(mfrow=c(1,3))
plot(predict(ajsp),residuals(ajsp),pch='*',
col=1,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajsp),xlab='resíduos(m)',ylab='frequência',main='',col='black');
plot(dados$id2,predict(ajsp),pch='*',col='black',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='green');
dados_npar=read.csv2('dados_ra.csv')
dados_npar=subset(dados_npar,estrato==573116);
View(dados_npar)
library(cmrinvflor)
dados=parear_seqmed(
dados_npar[,c('parcela','id','hd','ab','vtcc')]);
bc_poli='hd2~b0*((hd1/b0)^((id1/id2)^b2))';
ajbcp=nls(bc_poli,dados,start=list(b0=50,b2=0.5));
sumário_ajbcp=summary(ajbcp);
(sumario=summary(ajbcp));
hdest2=predict(ajbcp);
errounid=residuals(ajbcp);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajbcp$sigma;
nsyx=round(sumário_ajbcp$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajbcp$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajbcp$sigma/mean(dados$hd2))*100,5)))
x11()
par(mfrow=c(1,3))
plot(predict(ajbcp),residuals(ajbcp),pch='*',
col=3,xlab='hdom estimado (m)',
ylab='resíduos (m)', ylim=c(-5,5));
abline(h=0);
hist(residuals(ajbcp),xlab='resíduos(m)',ylab='frequência',main='',col='green');
plot(dados$id2,predict(ajbcp),pch='*',col='blue',
xlab='idade(meses)', ylab='altura dominante');
points(dados$id2,dados$hd2,pch='*',col='green');
#Download library fBasics para ver se a distribuição dos residuos é normal, se estiver todos dentro do intervalo
setwd("C:/Users/LuizPaulo/Desktop/UFSCar/Manejo de plantadas/Manejo (LP)/Trabalho final alessandro/Trabalho FINAL/1 - Ajuste Modelos/Schumacher Ana")
library(cmrinvflor);
dados_npar=read.csv2('dados_ra.csv');
dados_npar=subset(dados_npar,estrato==573116);
dados=parear_seqmed(subset(dados_npar,,c('parcela','id','hd','ab','vtcc')))  ; # em c(parcela= 1º)coluna do identificador,  2º) coluna que ordena, 3º) colunas que vão ser pareadas
with(dados_npar,plot(hd,vtcc,pch='*',col='red'));
schu_ana='hd2~hd1*exp(b1*(1/id1-1/id2))'
ajsa=nls(schu_ana,data=dados,start=list(b1=30)); #ajuste beatley cutter anamorfico / start=parametros iniciais, se ajustou quer dizer que o parametro inicial foi valido)
sumário_ajsa=summary(ajsa);
summary(ajsa); # eroo padrao residual+/-1,43m
hdest2=predict(ajsa);
errounid=residuals(ajsa);
erroperc=(errounid/dados$hd2)*100;
erropad=errounid/sumário_ajsa$sigma;
nsyx=round(sumário_ajsa$sigma,5);nsyx;
print(paste('Erro padrão residual (m):',nsyx=round(sumário_ajsa$sigma,5)));
print(paste('Erro padrão residual em porcentagem (%):', nsyx=round((sumário_ajsa$sigma/mean(dados$hd2))*100,5)))
# mudou-se na planilha do excel:
# idade para id
# hdom para hd
library(cmrinvflor);
# Dados y = lucro anual de empresas; x1=capital investido; x2=gasto com publicidade
Y=matrix(c(12,3,11,1,13,20,2,25,26,15,1,15,11,5,7), ncol=1, nrow=15);
x1=matrix(c(18,16,25,12,20,35,17,25,39,20,18,29,20,16,29), ncol=1, nrow=15);
x2=matrix(c(2,3,2,3,3,2,1.5,5,1,2.5,2,3.5,5,1,1.5), ncol=1,nrow=15);
dados<-data.frame(Y,X1,X2)
dados<-data.frame(Y,x1,x2)
View(dados)
anova(dados)
aov(dados)
aov(dados$Y)
Anova(dados)
library(car)
Anova(dados)
